<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Car Service</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
</head>

<body>
  <main>
    <section class="wrapper">
      <div class="container">
        <div style="height: 100vh;" class="row align-items-center">
          <div class="col-sm-8 offset-sm-2 col-lg-6 offset-lg-3 col-xl-4 offset-xl-4 text-left">
            <form id="login-form" class="rounded bg-white shadow py-5 px-4">
              <h3 class="text-dark fw-bolder fs-4 mb-2">Car Service</h3>
              <div class="fw-normal text-muted mb-4"> New Here? <br>
                <a href="register.html" class="text-info fw-bold text-decoration-none">Create an Account<br><br></a>
              </div>
              <div class="form-floating mb-3">
                <input type="email" name="email" class="form-control" id="floatingInput" placeholder="name@example.com">
                <label for="floatingInput">Email address <br><br></label>
              </div>
              <div class="form-floating">
                <input type="password" name="password" class="form-control" id="floatingPassword" placeholder="Password">
                <label for="floatingPassword">Password<br><br></label>
              </div>
              <div class="mt-2 text-end">
                <a href="#" class="text-info fw-bold text-decoration-none">Forgot Password ?<br><br></a>
              </div>
              <button type="submit" class="btn btn-info text-white submit_btn w-100 my-4">Login</button>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    document.getElementById("login-form").addEventListener("submit", function(event) {
      event.preventDefault(); // Prevent form submission

      // Get email and password values from input fields
      var email = document.getElementsByName("email")[0].value;
      var password = document.getElementsByName("password")[0].value;

      // Create request body object
      var requestBody = {
        "email": email,
        "password": password
      };

      // Send POST request to the API
      fetch("http://localhost/WebProjekat/CarService/rest/staging/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(requestBody)
        })
        .then(response => response.json())
        .then(data => {
          // Store the received token in localStorage
          localStorage.setItem("token", data.token);

          // Redirect to the specified URL
          window.location.href = "http://localhost/WebProjekat/CarService/frontend/home.html";
        })
        .catch(error => {
          console.error("Error:", error);
        });
    });
  </script>
</body>

</html>